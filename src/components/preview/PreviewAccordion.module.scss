@use '../../styles/variables' as v;
@use '../../styles/mixins' as m;
@use '../../styles/semantic' as s;

// ─────────────────────────────────────────
// PreviewAccordion — Premium Accordion UI
// Uses CSS grid-template-rows for buttery
// smooth height animations.
// ─────────────────────────────────────────

.groupContainer {
  width: 100%;
  border-radius: v.$radius-lg;
  margin-bottom: 12px;
  overflow: hidden;
  transition:
    box-shadow 300ms v.$ease-ios,
    border-color 300ms v.$ease-ios,
    background-color 200ms ease;

  // ── Mode: subtle ──────────────────────
  &.subtle {
    background-color: v.$grey-50;
    border: 1px solid v.$grey-100;

    .groupTitle {
      color: v.$grey-900;
    }

    .icon {
      color: v.$grey-400;
    }

    &.expanded {
      border-color: s.$border-active;
      box-shadow: v.$shadow-sm;
    }

    @media (hover: hover) and (pointer: fine) {
      &:hover {
        border-color: v.$grey-200;
      }
    }
  }

  // ── Mode: accent ──────────────────────
  &.accent {
    background-color: var(--accent-bg);

    .groupTitle {
      color: var(--accent-text);
    }

    .icon {
      color: var(--accent-text);
      opacity: 0.7;
    }

    &.expanded .icon {
      opacity: 1;
    }
  }

  // ── Mode: white ───────────────────────
  &.white {
    background-color: v.$white;
    border: 1px solid v.$grey-100;
    box-shadow: v.$shadow-sm;

    .groupTitle {
      color: v.$grey-900;
    }

    .icon {
      color: v.$grey-400;
    }

    &.expanded {
      box-shadow: v.$shadow-md;
      border-color: s.$border-active;
    }
  }

  &:last-child {
    margin-bottom: 0;
  }
}

// ── Header trigger ────────────────────────
.groupHeader {
  width: 100%;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 20px;
  gap: 12px;
  cursor: pointer;
  background: none;
  border: none;
  outline: none;
  text-align: left;
  -webkit-tap-highlight-color: transparent;
  min-height: v.$control-height-md;
  transition: opacity 150ms ease;

  @include m.focus-subtle;

  &:active {
    opacity: 0.7;
  }

  @media (hover: hover) and (pointer: fine) {
    &:hover {
      opacity: 0.85;
    }
  }
}

.groupTitle {
  font-size: v.$control-font-size-md;
  font-family: inherit;
  font-weight: 600;
  letter-spacing: -0.02em;
  line-height: 1.4;
  flex: 1;
}

// ── Chevron rotation ──────────────────────
.chevronWrap {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 28px;
  height: 28px;
  border-radius: v.$radius-full;
  background-color: transparent;
  transition:
    transform 400ms v.$ease-ios,
    background-color 200ms ease;
  flex-shrink: 0;

  &.chevronOpen {
    transform: rotate(-180deg);
  }
}

.icon {
  transition: color 200ms ease;
}

// ── Content area (CSS grid animation) ─────
.groupContent {
  display: grid;
  grid-template-rows: 0fr;
  transition: grid-template-rows 400ms v.$ease-ios;
  overflow: hidden;

  &.open {
    grid-template-rows: 1fr;
  }
}

// The inner wrapper must have min-height: 0;
// for the grid row collapse to work properly.
.innerContent {
  min-height: 0;
  overflow: hidden;
  padding: 0 20px;
  opacity: 0;
  transition: opacity 300ms v.$ease-ios;

  .open & {
    opacity: 1;
    padding-bottom: 20px;
  }
}
