@use '../../../styles/variables' as v;
@use '../../../styles/mixins' as m;

.wrapper {
  display: flex;
  flex-direction: row; // Split layout
  width: 100%;
  height: auto;
  flex: 1; // Ensure it fills the parent flex container (scrollArea)
  min-height: 0; // Handled deeply
  overflow: hidden; // Parent manages layout, children scroll
  align-items: stretch; // Ensure sidebar stretches

  // Add fade in for the whole component
  animation: fadeIn 0.4s ease-out;
}

.navRail {
  display: flex;
  flex-direction: column;
  width: 80px; // Fixed width sidebar
  height: auto;
  min-height: 0;
  align-self: stretch;
  background-color: v.$white;
  border-right: 1px solid v.$grey-200;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 12px 8px;
  gap: 8px;
  flex-shrink: 0;
  z-index: 10;
  position: relative; // Context for .activeIndicator

  &::-webkit-scrollbar {
    display: none;
  }
  -ms-overflow-style: none;
  scrollbar-width: none;
}

.navItem {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 64px;
  height: 64px;
  padding: 4px;
  border: none;
  background-color: transparent;
  border-radius: 16px; // Rounded shape as per design
  cursor: pointer;
  transition: all 0.2s v.$ease-ios;
  color: v.$grey-800;
  gap: 4px;
  flex-shrink: 0; // Prevent shrinking on small screens to maintain alignment with activeIndicator

  &:not(.active):hover {
    background-color: v.$grey-50;
    color: v.$grey-800;
  }

  &.active {
    color: v.$on-primary; // Deep Brown for better contrast & aesthetic
    // background-color is now handled by .activeIndicator
  }

  &.invalid {
    animation: pulseError 2s infinite ease-in-out;
  }
}

.navItemLayer {
  position: relative;
  z-index: 1;
}

.activeIndicator {
  position: absolute;
  left: 8px; // Matches parent padding-left
  top: 0; // Base position, will be transformed
  width: 64px;
  height: 64px;
  background-color: v.$primary; // Unified with Save button color
  border-radius: 16px;
  z-index: 0;
  transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
  pointer-events: none;
  box-shadow: v.$shadow-sm; // Add depth for consistency
}

.navIcon {
  width: 24px;
  height: 24px;
  margin-bottom: 2px;
}

.navLabel {
  font-size: 11px;
  font-weight: 600;
  letter-spacing: -0.01em;
  white-space: nowrap;
}

.contentArea {
  flex: 1;
  height: auto;
  min-height: 0;
  overflow-y: auto;
  overflow-x: hidden;
  position: relative;

  // Apply constraints directly to the form (which has this class)
  // But since it's a form element, we want to center its content perhaps?
  // If we set max-width on the form element + margin: 0 auto,
  // the scrollbar will be on the form element itself if we set overflow-y on it.

  // Actually, we set overflow-y on .contentArea.
  // If .contentArea IS the form, then scrollbar is on the form.
  // If we set max-width: 600px on the form, the form will be narrow.
  // The scrollbar will be on the narrow form.
  // This looks weird (scrollbar in middle of screen).

  // Better: Make form full width, and constrain children?
  // But children are injected via SECTIONS.map.
  // We can't easily constrain children without a wrapper.

  // Alternative: Don't constrain width, just use full width.
  // Mobile first design usually is full width.
  // On Desktop, maybe pass max-width via a wrapper inside EditorForm?
  // Current design is 480px sidebar.
  // 64px nav + 416px content.
  // 416px is narrow enough. No need for max-width limitation.

  &::-webkit-scrollbar {
    display: none;
  }
}

.loadingContainer {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
  padding: 20px;
}

.invalidSummaryList {
  display: flex;
  flex-direction: column;
  gap: v.$space-sm;
}

.invalidSummaryButton {
  &:focus {
    outline: none;
  }

  &:focus-visible {
    outline: none;
    box-shadow: none;
    border-color: v.$primary;
    background-color: v.$primary-50;
    color: v.$grey-900;
  }
}

.skeletonItem {
  background-color: v.$white;
  border-radius: v.$radius-md;
  padding: 1rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.skeletonLeft {
  display: flex;
  align-items: center;
  gap: 0.75rem;
}

.skeletonIcon {
  width: 2.5rem;
  height: 2.5rem;
  border-radius: v.$radius-md;
}

.skeletonText {
  display: flex;
  flex-direction: column;
  gap: 0.375rem;
}

.skeletonTitle {
  width: 6rem;
  height: 1rem;
  border-radius: v.$radius-full;
}

.skeletonSubtitle {
  width: 4rem;
  height: 0.75rem;
  border-radius: v.$radius-full;
  opacity: 0.6;
}

.skeletonChevron {
  width: 1rem;
  height: 1rem;
  border-radius: v.$radius-full;
  opacity: 0.3;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes pulseError {
  0% {
    border: 1px solid rgba(v.$color-error, 0.2);
  }
  50% {
    border: 1px solid v.$color-error; // More visible pulse
  }
  100% {
    border: 1px solid rgba(v.$color-error, 0.2);
  }
}
